<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.53fb669f1e3cd4ed29f3.css" id="gatsby-global-css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5;--color-bg-dark:#282c35;--color-text-dark:hsla(0,0%,100%,0.88);--color-heading-dark:#ffa7c4;--color-heading-black-dark:#fff}*,:after,:before{box-sizing:border-box}html{line-height:var(--lineHeight-normal);font-size:var(--fontSize-root);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body{font-family:var(--font-body);font-size:var(--fontSize-1)}body.light-mode{color:var(--color-text)}body.dark-mode{color:var(--color-text-dark);background-color:var(--color-bg-dark)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);height:1px;border:0}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);margin-top:var(--spacing-12);margin-bottom:var(--spacing-6);line-height:var(--lineHeight-tight);letter-spacing:-.025em}h2.light-mode,h3.light-mode,h4.light-mode,h5.light-mode,h6.light-mode{font-weight:var(--fontWeight-bold);color:var(--color-heading)}h2.dark-mode,h3.dark-mode,h4.dark-mode,h5.dark-mode,h6.dark-mode{font-weight:var(--fontWeight-bold);color:var(--color-heading-dark)}h1{font-weight:var(--fontWeight-black);font-size:var(--fontSize-5)}h1.light{color:var(--color-heading-black)}h1.dark{color:var(--color-heading-black-dark)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{line-height:var(--lineHeight-relaxed);--baseline-multiplier:0.179;--x-height-multiplier:0.35;margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{margin-left:var(--spacing-0);margin-right:var(--spacing-0);margin-bottom:var(--spacing-8);list-style-position:outside;list-style-image:none}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{color:var(--color-text-light);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6);border-left:var(--spacing-1) solid var(--color-primary);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{width:100%;margin-bottom:var(--spacing-8);border-collapse:collapse;border-spacing:.25rem}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12);display:flex;flex-direction:row;justify-content:space-between}.main-heading{font-size:var(--fontSize-5);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-weight:var(--fontWeight-bold);font-family:var(--font-heading);text-decoration:none;font-size:var(--fontSize-2)}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio-avatar,.bio p{margin-bottom:var(--spacing-0)}.bio-avatar{margin-right:var(--spacing-4);min-width:50px;border-radius:100%}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-size:var(--fontSize-2);font-family:var(--font-heading)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4);margin-left:var(--spacing-0)}ol,ul{list-style-position:inside}}.tag-view{display:inline-block;margin-right:1rem;border-width:1px;border-style:solid;padding:0 .5rem;border-radius:3px;cursor:pointer}code[class*=language-],pre[class*=language-]{color:#000;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.light-mode code[class*=language-],.light-mode pre[class*=language-]{color:#000;text-shadow:0 1px #fff}.dark-mode code[class*=language-],.dark-mode pre[class*=language-]{color:#f8f8f2;text-shadow:0 1px 0 1px rgba(0,0,0,.3)}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}.light-mode :not(pre)>code[class*=language-],.light-mode pre[class*=language-]{background:#f5f2f0}.dark-mode :not(pre)>code[class*=language-],.dark-mode pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.light-mode .token.comment,.token.cdata,.token.doctype,.token.prolog{color:#708090}.dark-mode .token.comment,.token.cdata,.token.doctype,.token.prolog{color:#8292a2}.light-mode .token.punctuation{color:#999}.dark-mode .token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.light-mode .token.property,.token.boolean,.token.constant,.token.deleted,.token.number,.token.symbol,.token.tag{color:#905}.dark-mode .token.property,.token.constant,.token.deleted,.token.symbol,.token.tag{color:#f92672}.dark-mode .token.boolean,.token.number{color:#ae81ff}.light-mode .token.selector,.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.string{color:#690}.dark-mode .token.selector,.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.string{color:#a6e22e}.language-css .token.string,.light-mode .token.operator,.style .token.string,.token.entity,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.dark-mode .token.operator,.language-css .token.string,.style .token.string,.token.entity,.token.url,.token.variable{color:#f8f8f2}.light-mode .token.atrule,.token.attr-value,.token.keyword{color:#07a}.light-mode .token.function,.token.class-name{color:#dd4a68}.dark-mode .token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.dark-mode .token.keyword{color:#66d9ef}.light-mode .token.regex,.token.important,.token.variable{color:#e90}.dark-mode .token.regex,.token.important{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.react-toggle{touch-action:pan-x;display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.react-toggle-screenreader-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle--disabled{cursor:not-allowed;opacity:.5;transition:opacity .25s}.react-toggle-track{width:50px;height:24px;padding:0;border-radius:30px;background-color:#4d4d4d;transition:all .2s ease}.react-toggle:hover:not(.react-toggle--disabled) .react-toggle-track{background-color:#000}.react-toggle--checked .react-toggle-track{background-color:#19ab27}.react-toggle--checked:hover:not(.react-toggle--disabled) .react-toggle-track{background-color:#128d15}.react-toggle-track-check{position:absolute;width:14px;height:10px;top:4px;margin-top:auto;margin-bottom:auto;line-height:0;left:8px;opacity:0;transition:opacity .25s ease}.react-toggle--checked .react-toggle-track-check,.react-toggle-track-x{opacity:1;transition:opacity .25s ease}.react-toggle-track-x{position:absolute;width:10px;height:10px;top:4px;margin-top:auto;margin-bottom:auto;line-height:0;right:10px}.react-toggle--checked .react-toggle-track-x{opacity:0}.react-toggle-thumb{transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;position:absolute;top:1px;left:1px;width:22px;height:22px;border:1px solid #4d4d4d;border-radius:50%;background-color:#fafafa;box-sizing:border-box;transition:all .25s ease}.react-toggle--checked .react-toggle-thumb{left:27px;border-color:#19ab27}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 2px 3px #0099e0}.react-toggle:active:not(.react-toggle--disabled) .react-toggle-thumb{box-shadow:0 0 5px 5px #0099e0}</style><meta name="generator" content="Gatsby 3.4.1"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=cb0348da83085f341829f81b843fa542" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=cb0348da83085f341829f81b843fa542"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=cb0348da83085f341829f81b843fa542"/><title data-react-helmet="true">HTTP之二：HTTP Headers | 按太阳穴轮刮眼眶</title><meta data-react-helmet="true" name="description" content="按照数据编码、国际化、文件传输、连接管理、重定向、Cookie、缓存控制、代理、缓存代理等类别, 详细描述了常用HTTP Headers的使用方法和要点."/><meta data-react-helmet="true" property="og:title" content="HTTP之二：HTTP Headers"/><meta data-react-helmet="true" property="og:description" content="按照数据编码、国际化、文件传输、连接管理、重定向、Cookie、缓存控制、代理、缓存代理等类别, 详细描述了常用HTTP Headers的使用方法和要点."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="HTTP之二：HTTP Headers"/><meta data-react-helmet="true" name="twitter:description" content="按照数据编码、国际化、文件传输、连接管理、重定向、Cookie、缓存控制、代理、缓存代理等类别, 详细描述了常用HTTP Headers的使用方法和要点."/><link as="script" rel="preload" href="/webpack-runtime-b6b5473299e7c9f504ce.js"/><link as="script" rel="preload" href="/framework-e954ed135b27c92e5196.js"/><link as="script" rel="preload" href="/app-065bd1c7906a1152e68e.js"/><link as="script" rel="preload" href="/commons-05ebe9de21711bd0a6d1.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-97982a6270918782dbd4.js"/><link as="fetch" rel="preload" href="/page-data/http-2/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3257411868.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>!function(e,a,o){function d(e){document.body.classList.add(e?"dark-mode":"light-mode"),document.body.classList.remove(e?"light-mode":"dark-mode")}var t=window.matchMedia("(prefers-color-scheme: dark)"),r="(prefers-color-scheme: dark)"===t.media,s=null;try{s=localStorage.getItem("darkMode")}catch(e){}var c=null!==s;if(c&&(s=JSON.parse(s)),c)d(s);else if(r)d(t.matches),localStorage.setItem("darkMode",t.matches);else{var l=document.body.classList.contains("dark-mode");localStorage.setItem("darkMode",JSON.stringify(l))}}();</script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">按太阳穴轮刮眼眶</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">HTTP之二：HTTP Headers</h1><p>August 10, 2021</p></header><section itemProp="articleBody"><h2>数据类型与编码</h2>
<h3>MIME type</h3>
<p>全称“多用途互联网邮件扩展”(Multipurpose Internet Mail Extensions), 用于标记 body 的数据类型, 形式是 <code class="language-text">type/subtype</code> 的字符串, 常用的有:</p>
<ul>
<li>text: <code class="language-text">text/html</code> <code class="language-text">text/css</code> <code class="language-text">text/plain</code></li>
<li>image: <code class="language-text">image/gif</code> <code class="language-text">image/jpeg</code> <code class="language-text">image/png</code></li>
<li>audio/video: <code class="language-text">audio/mpeg</code> <code class="language-text">video/mp4</code></li>
<li>application: <code class="language-text">application/json</code> <code class="language-text">application/javascript</code> <code class="language-text">application/pdf</code> <code class="language-text">application/octet-stream</code></li>
</ul>
<h3>数据编码/压缩</h3>
<ul>
<li>gzip: GNU zip, 对于文本数据通常超过 60%压缩率</li>
<li>deflate: zlib</li>
<li>br: 专为 HTTP 优化的新压缩算法 Brotli, 通常比 gzip 还好</li>
</ul>
<h3>数据类型相关 Headers</h3>
<ul>
<li>
<p>请求头: 客户端声明希望/能够接收的数据类型</p>
<ul>
<li>Accept: text/html, application/json, image/png, image/webp</li>
<li>Accept-Encoding: gzip, deflate, br</li>
</ul>
</li>
<li>
<p>响应头: 服务端告知实际发送的数据类型</p>
<ul>
<li>Content-Type: text/html</li>
<li>Content-Encoding: gzip</li>
</ul>
</li>
</ul>
<h2>国际化 i18n</h2>
<p>主要分为语言和字符集:</p>
<ul>
<li>
<p>请求头</p>
<ul>
<li>Accept-Language: zh-CN, zh, en</li>
<li>Accept-Charset: utf-8, gbk</li>
</ul>
</li>
<li>
<p>响应头</p>
<ul>
<li>Content-Language: zh-CN</li>
<li>Content-Type: text/html; charset=utf-8</li>
<li>字符集在响应头中没有单独的字段, 而是作为 Content-Type 的后半部分</li>
</ul>
</li>
</ul>
<blockquote>
<p><code class="language-text">Accept-Charset</code> 和 <code class="language-text">Content-Language</code> 通常不会发送.</p>
</blockquote>
<h3>优先级</h3>
<p>可以在 <code class="language-text">Accept</code> <code class="language-text">Accept-Encoding</code> <code class="language-text">Accept-Language</code> 等请求头字段中的内容中添加 <code class="language-text">q</code> 参数来设定优先级, 如 <code class="language-text">Accept: text/html, application/xml;q=0.9</code> .</p>
<p>优先级默认以及最大为 1, 最小为 0.01.</p>
<p>注: 在此处 <code class="language-text">;</code> 的断句小于 <code class="language-text">,</code> , 表示仅作用于分号之前的一个内容.</p>
<h3>响应头中的 Vary</h3>
<p>表示服务器在内容协商时参考的请求头字段, 如:</p>
<p><code class="language-text">Vary: Accept-Encoding,User-Agent,Accept</code></p>
<p>请求头变化时, Vary 也可能变化, 主要用于在传输链路中间的代理服务器实现缓存服务, 后文 <strong>缓存代理</strong> 部分详述.</p>
<h2>大文件传输</h2>
<h3>分块传输/Transfer-Encoding</h3>
<ul>
<li>
<p>响应头: <code class="language-text">Transfer-Encoding: chunked</code></p>
<ul>
<li>与 <code class="language-text">Content-Length</code> 字段互斥, 要么长度已知, 要么是 chunked(长度未知).</li>
<li><code class="language-text">Transfer-Encoding</code> 字段值可以是 <code class="language-text">gzip</code> <code class="language-text">deflate</code> 等, 表示压缩编码; 与 <code class="language-text">Content-Encoding</code> 相比, <code class="language-text">Transfer-Encoding</code> 在传输后将被自动解码.</li>
</ul>
</li>
<li>
<p>每个分块内容:</p>
<ul>
<li>length + CRLF</li>
<li>chunked data + CRLF</li>
</ul>
</li>
<li>
<p>分块末尾</p>
<ul>
<li>0 + CRLF (length 为 0)</li>
<li>CRLF (空行结尾)</li>
<li>末尾允许有拖尾数据 <code class="language-text">Trailer</code></li>
</ul>
</li>
</ul>
<h3>范围请求/Range</h3>
<p>获取文件的一部分, 如视频进度拖拽、多线程并发下载、断点续传.</p>
<p>服务器在响应头中添加 <code class="language-text">Accept-Ranges: bytes</code> 来告知客户端支持范围请求.</p>
<p>客户端在请求头中添加 <code class="language-text">Range: bytes=x-y</code> 来进行范围请求.</p>
<ul>
<li>x、y 表示从 0 开始的偏移量</li>
<li>x、y 可省略其中之一, 但 <code class="language-text">-</code> 不能省略, 如: <code class="language-text">bytes=10-</code> <code class="language-text">bytes=-20</code></li>
</ul>
<p>服务器接收到 <code class="language-text">Range</code> 字段后,</p>
<ol>
<li>检查范围是否合法, 不合法返回 416;</li>
<li>若范围合法, 根据 Range 头偏移量读取文件片段, 确定状态码 206(Partial Content);</li>
<li>服务器添加响应头字段 <code class="language-text">Content-Range: bytes x-y/length</code> , length 表示总长度;</li>
<li>通过 TCP 发送数据</li>
</ol>
<p>Range 是针对原文件的范围, 而不是压缩后的文件范围(除非原文件就是 gzip 的).</p>
<p>条件范围请求 <code class="language-text">If-Range</code> 在后文详述.</p>
<h3>多段数据</h3>
<p>在 <code class="language-text">Range</code> 请求头中添加逗号分隔的多段范围, 如: <code class="language-text">Range: bytes=0-9, 20-29</code>.</p>
<p>响应头中多段数据得到的数据 MIME 类型为 <code class="language-text">multipart/byteranges</code> , 同时需要给出段之间的 <code class="language-text">boundary=xxx</code> , 如: <code class="language-text">Content-Type: multipart/byterange; boundary=00000000001</code>.</p>
<p>具体的数据如下</p>
<ul>
<li>以双“-”开头的分隔符: <code class="language-text">--{boundary}</code> + CRLF</li>
<li>数据类型: <code class="language-text">Content-Type: type/subtype</code> + CRLF</li>
<li>Range: <code class="language-text">Content-Range: types x-y/length</code> + CRLF</li>
<li>空行 CRLF</li>
<li>分段数据 multipart data + CRLF</li>
<li>(下一段数据)分隔符: <code class="language-text">--{boundary}</code> + CRLF</li>
<li>…其他数据</li>
<li>分段结束: <code class="language-text">--{boundary}--</code> + CRLF</li>
</ul>
<h2>连接管理/Connection</h2>
<h3>短连接和长连接</h3>
<p>HTTP 0.9/1.0 使用短连接, 收到响应后立刻关闭连接, 效率很低:</p>
<ul>
<li>TCP 三次握手建立连接 → 请求 → 响应 → TCP 四次握手断开连接</li>
</ul>
<p>HTTP/1.1 默认使用长连接, 在一次连接中收发多个请求-响应.</p>
<ul>
<li>请求头和响应头加 <code class="language-text">Connection: keep-alive</code> 表示支持长连接</li>
<li>请求头和响应头加 <code class="language-text">Connection: close</code> 告知对方本次通信后关闭连接</li>
<li>请求头和响应头加 <code class="language-text">Keep-Alive: timeout=value</code> 限定超时时间(约束力不强,可能不遵守)</li>
<li>Nginx 可以设置 <code class="language-text">keepalive_timeout</code> 和 <code class="language-text">keepalive_request</code> 规定一次连接的超时时间和最大请求数</li>
<li>Connection 的另一个值 <code class="language-text">Upgrade</code> 配合状态码 101, 表示协议升级, 如 HTTP 升级为 WebSocket</li>
<li>HTTP 还有第三种连接方式 “pipeline”, 但主流浏览器都未实现, 事实上“废弃”了.</li>
</ul>
<h3>队首阻塞问题</h3>
<p>HTTP 规定的“请求-响应”模型是先进先出的串行队列, 即 <strong>同域名</strong> 下收到前一次的响应后才能发起新请求, 一次收发过慢时会导致后续所有请求被阻塞.</p>
<ul>
<li>利用 HTTP 长连接特性对服务器发起大量请求, 导致服务器耗尽资源, 就是 <strong>DDoS</strong> .</li>
</ul>
<p>由于 HTTP/1.1 的“请求-应答”模型不能变, 只能通过数量来暂时“解决”质量问题:</p>
<ul>
<li>并发连接数: 浏览器支持 6~8 个同域并发长连接</li>
<li>域名分片: 使用多个域名指向同一台服务器</li>
</ul>
<h2>重定向和跳转/Location</h2>
<p>当状态码 301/302 时为重定向, 响应头 <code class="language-text">Location</code> 标记重定向 URL.</p>
<p><code class="language-text">Location</code> 支持绝对和相对 URI, 如 <code class="language-text">Location: /index.html</code> .</p>
<p>循环跳转: 几个 URI 连续重定向导致无限循环, 浏览器可以检测循环跳转并提示失败.</p>
<p><code class="language-text">Refresh</code> 延时重定向, 如 <code class="language-text">Refresh: 5; url=xxx</code> 表示 5 秒后跳转.</p>
<p><code class="language-text">Referer</code> 和 <code class="language-text">Referrer-Policy</code> 表示浏览器跳转来源, 用于统计分析或防盗链.</p>
<p><code class="language-text">3xx</code> 状态码重定向由浏览器执行, 对于服务器来说是“外部重定向”, 服务器的“内部重定向”是在服务器中直接跳转 URI.</p>
<h3>重定向相关状态码</h3>
<ul>
<li>301: 永久重定向, 会更新浏览器历史记录和书签;</li>
<li>302: 临时重定向, 仅本次访问有效;</li>
<li>
<p>其他状态码, 浏览器和服务器不一定支持:</p>
<ul>
<li>303 See Other: 类似 302, 但要改为 <code class="language-text">GET</code> 方法避免重复操作;</li>
<li>307 Temporary Redirect: 类似 302, 要求重定向后的方法和实体不变;</li>
<li>308 Permanent Redirect: 301 + 307, 永久重定向且方法和实体不变.</li>
<li>300 Multiple Choices: 返回一个有多个链接选项的页面, 用户自行选择跳转</li>
</ul>
</li>
</ul>
<h2>Cookie</h2>
<p>服务器在响应头添加 <code class="language-text">Set-Cookie: key=value</code> , 给予客户端身份标识, 响应头可具有多个 <code class="language-text">Set-Cookie</code> .</p>
<p>客户端保存 Cookie 并在之后的请求头中添加 <code class="language-text">Cookie: key1=value1; key2=value2</code> , 请求头的 <code class="language-text">Cookie</code> 将多个 Cookie 合并为 <code class="language-text">;</code> 分隔的形式.</p>
<p>Cookie 最大 4K.</p>
<p>Cookie 不属于 HTTP 标准, 所以语法上与别的属性不一致(分隔符是分号而非逗号).</p>
<h3>Cookie 属性</h3>
<p>一个真实 Cookie: <code class="language-text">Set-Cookie: favorite=humburger; Max-Age=10; Expires=Fri, 07-Jun-19 08:19:00 GMT; Domain=www.xxx.com; Path=/; HttpOnly; SameSite=Strict</code></p>
<p>有效期:</p>
<ul>
<li><code class="language-text">Expires</code> 过期的时间点</li>
<li><code class="language-text">Max-Age</code> 有效时间(秒数)</li>
<li>浏览器优先采用 <code class="language-text">Max-Age</code> , 如果不指定有效期, 则为会话 Cookie 关闭失效.</li>
</ul>
<p>作用域:</p>
<ul>
<li><code class="language-text">Domain</code> 域名</li>
<li><code class="language-text">Path</code> 路径, 使用 <code class="language-text">/</code> 表示该域名下任意路径</li>
<li>浏览器会进行对比, 如果请求 URI 不相符则不会发送 Cookie.</li>
</ul>
<p>安全性:</p>
<ul>
<li><code class="language-text">HttpOnly</code> 禁止非 HTTP 协议方式访问,禁用 <code class="language-text">document.cookie</code> 相关 API.</li>
<li>
<p><code class="language-text">SameSite</code> 防范“跨站请求伪造”(XSRF)攻击</p>
<ul>
<li><code class="language-text">SameSite=Strict</code> 限定 Cookie 不能随着跳转链接跨站发送</li>
<li><code class="language-text">SameSite=Lax</code> 允许 GET/HEAD 等安全方法, 禁止 POST 跨站发送</li>
</ul>
</li>
<li><code class="language-text">Secure</code> 该 Cookie 只能用 HTTPS 协议加密传输, 但 Cookie 本身在浏览器中还是明文存在</li>
</ul>
<blockquote>
<p>防范 XSS(跨站脚本攻击): <code class="language-text">HttpOnly</code> 禁止 JS 脚本访问 Cookie; <code class="language-text">Secure</code> 只在 HTTPS 时加密传输 Cookie.</p>
</blockquote>
<h3>Cookie 应用</h3>
<ul>
<li>身份识别: 登录信息、会话事务等</li>
<li>广告追踪: 用户被广告商加上 Cookie, 实现精准推送</li>
</ul>
<h2>Cache-Control</h2>
<h3>服务器端的缓存控制</h3>
<p>服务器在响应头中添加 <code class="language-text">Cache-Control</code> 控制浏览器缓存资源, 如 <code class="language-text">Cache-Control: max-age=30</code> .</p>
<ul>
<li><code class="language-text">max-age</code> 有效期(秒), 从响应报文的创建时刻开始计算.</li>
<li><code class="language-text">no_store</code> 不允许缓存</li>
<li>
<p><code class="language-text">no_cache</code> (语义相反)可以缓存, 需在服务器验证缓存是否有新版本</p>
<ul>
<li>相当于 <code class="language-text">max-age=0, must_revalidate</code></li>
</ul>
</li>
<li><code class="language-text">must-revalidate</code> 缓存未过期可使用, 过期需验证</li>
</ul>
<h3>浏览器端的缓存控制</h3>
<p>不使用缓存数据:</p>
<ul>
<li>刷新按钮: 浏览器在请求头中添加 <code class="language-text">Cache-Control: max-age=0</code> , 表示越过缓存获取新数据;</li>
<li>强制刷新(Ctrl+F5 或 Command+R): 请求头添加 <code class="language-text">Cache-Control: no-cache</code> , 通常与刷新效果相同, 取决于服务器处理.</li>
</ul>
<p>使用缓存数据的情况: 请求头中无 <code class="language-text">Cache-Control</code> 属性</p>
<ul>
<li>前进/后退 按钮</li>
<li>重定向跳转</li>
</ul>
<h3>条件请求</h3>
<p>先验证缓存是否有效, 若无效再请求新数据 需要两次请求, 成本过高. 所以 HTTP 定义了一系列 <code class="language-text">If</code> 开头的条件请求字段来合并数据验证和请求.</p>
<p>在首次请求中, 服务器在响应头中添加 <code class="language-text">Last-Modified</code> 和 <code class="language-text">ETag</code> 属性</p>
<p>通过缓存的更新时间:</p>
<ul>
<li>浏览器在请求头添加 <code class="language-text">If-Modified-Since</code> 属性</li>
<li>若缓存无更新, 服务器在响应头添加 <code class="language-text">Last-Modified</code> 属性并返回”304 Not Modified”, 浏览器更新缓存有效期</li>
</ul>
<p>通过 ETag(资源标识):</p>
<ul>
<li>浏览器在请求头添加 <code class="language-text">If-None-Match: &quot;xxxx&quot;</code></li>
<li>若本资源无更新则返回”304 Not Modified”并更新有效期</li>
<li>ETag 有”强” “弱”之分, 以 “W/”开头的为弱 ETag, 只要求资源在语义上无变化, 但内部可能发生变化; 强 ETag 要求资源在字节级别完全相符.</li>
</ul>
<h2>Proxy</h2>
<p><code class="language-text">Via</code> 在请求和响应头可以出现, 没经过一个代理就追加一个代理主机名/域名, 如 <code class="language-text">Via: proxy1, proxy2</code> .</p>
<ul>
<li>有的响应报文会使用 <code class="language-text">X-Via</code> , 与 <code class="language-text">Via</code> 含义相同</li>
</ul>
<p>两个常用的事实上的标准(非 HTTP 标准):</p>
<ul>
<li>
<p><code class="language-text">X-Forwarded-For</code> 与 <code class="language-text">Via</code> 类似, 但追加的是请求方的 IP 地址.</p>
<ul>
<li><code class="language-text">X-Forwarded-Host</code> 记录主机名</li>
<li><code class="language-text">X-Forwarded-Proto</code> 记录协议名</li>
</ul>
</li>
<li><code class="language-text">X-Real-IP</code> 记录客户端 IP 地址, 无中间代理信息.</li>
</ul>
<h3>抓包含代理的通信过程</h3>
<ul>
<li>客户端与代理的 80 端口通过三次握手建立 TCP 连接;</li>
<li>客户端向代理发送 HTTP 请求, 代理接收并返回 ACK 确认;</li>
<li>代理与源服务器通过三次握手建立 TCP 连接;</li>
<li>代理向源服务器发送 HTTP 请求, 源服务器接收并返回 ACK 确认;</li>
<li>源服务器向代理发送 HTTP 响应, 代理接收并返回 ACK 确认;</li>
<li>代理与源服务器通过四次挥手断开 TCP 连接;</li>
<li>代理将响应数据发给客户端, 客户端接收并返回 ACK 确认.</li>
</ul>
<h3>代理协议</h3>
<p>由于 <code class="language-text">X-Forwarded-For</code> 要解析和修改 HTTP Headers, 会影响性能, 在加密通信中甚至无法实现, 所以出现了一个事实标准 <strong>代理协议/The PROXY protocol</strong> .</p>
<p>代理协议有 v1 和 v2 两个版本:</p>
<ul>
<li>
<p>v1: 明文, 在 HTTP 报文前增加一行 ASCII 码文本:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token constant">PROXY</span> <span class="token constant">TCP4</span> <span class="token number">1.1</span><span class="token number">.1</span><span class="token number">.1</span> <span class="token number">2.2</span><span class="token number">.2</span><span class="token number">.2</span> <span class="token number">55555</span> <span class="token number">80</span>\r\n
<span class="token constant">GET</span> <span class="token operator">/</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>\r\n
<span class="token operator">...</span></code></pre></div>
<ul>
<li>必须 <code class="language-text">PROXY</code> 开头, 放在 HTTP 报文首行之前</li>
<li><code class="language-text">TCP4</code> 表示客户端的 IP 地址类型</li>
<li>之后是请求方地址, 应答方地址, 请求方端口, 应答方端口号</li>
<li>最后与 HTTP 报文一样以回车换行结束</li>
</ul>
</li>
<li>v2: 非明文二进制格式, 相对复杂可自行查阅.</li>
</ul>
<h2>Cache Proxy</h2>
<p>处于客户端和源服务器之间, 作为数据的中转站.</p>
<p>面向源服务器时是客户端, 面相客户端时是服务器.</p>
<h3>服务端的缓存控制</h3>
<p>在<code class="language-text">Cache-Control</code> 响应头中可以对客户端和代理的缓存策略进行配置.</p>
<p>首先是四个基本属性 <code class="language-text">max-age</code> <code class="language-text">no_store</code> <code class="language-text">no_cache</code> <code class="language-text">must-revalidate</code> 可以通过添加 <code class="language-text">private</code> 或 <code class="language-text">public</code> 约束客户端和代理的缓存策略:</p>
<ul>
<li><code class="language-text">private</code> 表示客户端私有缓存, 如用户信息 Cookie.</li>
<li><code class="language-text">public</code> 表示客户端与代理都可以进行缓存</li>
</ul>
<p>其次, <code class="language-text">Cache-Control</code> 还可以添加 <code class="language-text">must-revalidate</code> 或 <code class="language-text">proxy-revalidate</code> 属性, 用于说明在缓存失效时必须回源服务器验证还是只验证代理即可.</p>
<p><code class="language-text">s-maxage</code> 用于单独标识代理端的缓存生效时间, 与客户端的 <code class="language-text">max-age</code> 类似.</p>
<p><code class="language-text">no-transform</code> 代理专用属性, 表示禁止对数据进行优化处理(一些代理可能会对某些数据进行一些优化处理).</p>
<p><strong>注意:</strong> 服务器设置完 <code class="language-text">Cache-Control</code> 后要添加 <code class="language-text">Last-modified</code> 或 <code class="language-text">Etag</code> 响应头才能使用条件请求.</p>
<h3>客户端的缓存控制</h3>
<p>在 <strong>Cache-Control</strong> 部分讲述的的浏览器缓存控制对代理同样有效, 即通过 <code class="language-text">max-age</code> <code class="language-text">no_store</code> <code class="language-text">no_cache</code> 属性作用于源服务器和代理来进行缓存控制.</p>
<p>还有两个属性用于声明客户端对缓存有效期的偏移量限定:</p>
<ul>
<li><code class="language-text">max-stale</code> 可接受缓存过期 x 秒</li>
<li><code class="language-text">min-fresh</code> 缓存必须在当前以及 x 秒后未过期</li>
</ul>
<p><code class="language-text">only-if-cached</code> 属性表示客户端只接受代理缓存的数据, 如果代理没有缓存或缓存过期, 就返回 504.</p>
<h3>缓存数据匹配</h3>
<p>在 <strong>i18n</strong> 部分提到过 <code class="language-text">Vary</code> 字段, 表示服务器在内容协商时参考的请求头字段, 可以作为报文的一个版本标记. 如: <code class="language-text">Vary: Accept-Encoding,User-Agent,Accept</code> , 缓存代理会存储这些版本. 当再次收到相同请求时, 代理读取缓存的 <code class="language-text">Vary</code> , 匹配时缓存数据.</p>
<h3>缓存清理</h3>
<p>常用的做法是使用自定义请求方发 <code class="language-text">PURGE</code> 来告诉代理服务器删除本 URI 对应的缓存数据.</p>
<p>需要进行缓存清理的场景: 缓存数据过期; 源服务器存在新数据; 一些无用或有害数据.</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/cb0348da83085f341829f81b843fa542/d4bf4/profile-pic.avif 50w,/static/cb0348da83085f341829f81b843fa542/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/cb0348da83085f341829f81b843fa542/3faea/profile-pic.webp 50w,/static/cb0348da83085f341829f81b843fa542/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/cb0348da83085f341829f81b843fa542/e5610/profile-pic.png" data-srcset="/static/cb0348da83085f341829f81b843fa542/e5610/profile-pic.png 50w,/static/cb0348da83085f341829f81b843fa542/e9b55/profile-pic.png 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/cb0348da83085f341829f81b843fa542/d4bf4/profile-pic.avif 50w,/static/cb0348da83085f341829f81b843fa542/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/cb0348da83085f341829f81b843fa542/3faea/profile-pic.webp 50w,/static/cb0348da83085f341829f81b843fa542/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/cb0348da83085f341829f81b843fa542/e5610/profile-pic.png" srcSet="/static/cb0348da83085f341829f81b843fa542/e5610/profile-pic.png 50w,/static/cb0348da83085f341829f81b843fa542/e9b55/profile-pic.png 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><div><p><strong>佚树</strong> 的个人博客</p><p>关于前端、音乐与生活</p></div></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/npm/">← <!-- -->NPM/Yarn包管理策略与最佳实践</a></li><li><a rel="next" href="/http-3/">HTTP之三：安全的HTTPS<!-- --> →</a></li></ul></nav></main><footer><a href="https://www.github.com/hrayd/">github</a> · <a href="https://www.zhihu.com/people/artyhacker">zhihu</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/http-2/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-97863347e1e2ea8cfcbd.js"],"app":["/app-065bd1c7906a1152e68e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-f1bde5534fbdc04f234a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-a61f5dba934ef8f22a44.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-a4be0f194c3fdbe3e336.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-97982a6270918782dbd4.js"]};/*]]>*/</script><script src="/polyfill-97863347e1e2ea8cfcbd.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-97982a6270918782dbd4.js" async=""></script><script src="/commons-05ebe9de21711bd0a6d1.js" async=""></script><script src="/app-065bd1c7906a1152e68e.js" async=""></script><script src="/framework-e954ed135b27c92e5196.js" async=""></script><script src="/webpack-runtime-b6b5473299e7c9f504ce.js" async=""></script></body></html>